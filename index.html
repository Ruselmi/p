<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game Hub HD: UNO, Catur, Monopoly, Hand AI</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="hero">
      <h1>üéÆ Game Hub HD</h1>
      <p>UNO Flip/Mercy, Catur, Monopoly Board, Hand Avatar AI, dan multiplayer P2P antar device.</p>
    </header>

    <section class="p2p-box">
      <h2>üåê Opsi Main Online P2P (PeerJS)</h2>
      <div class="panel-row">
        <button id="createRoomBtn">Buat Room (4 kode)</button>
        <input id="joinCodeInput" maxlength="4" placeholder="kode room" />
        <button id="joinRoomBtn">Gabung Room</button>
        <button id="leaveRoomBtn">Keluar Room</button>
      </div>
      <p id="p2pStatus" class="status-pill">Offline</p>
      <p id="roomCodeBadge" class="status-pill">Room: -</p>
      <p class="hint">Host + maksimal 3 client (total 4 pemain). Bisa antar device dalam internet.</p>
    </section>

    <nav class="tabs">
      <button class="tab-btn active" data-tab="uno">UNO HD</button>
      <button class="tab-btn" data-tab="chess">Catur HD</button>
      <button class="tab-btn" data-tab="monopoly">Monopoly Board HD</button>
      <button class="tab-btn" data-tab="hand-ai">Hand Avatar AI</button>
    </nav>

    <main>
      <section id="uno" class="tab active">
        <h2>UNO HD Arena</h2>
        <div class="panel-row card-panel">
          <label for="unoMode">Mode UNO:</label>
          <select id="unoMode">
            <option value="classic">Classic</option>
            <option value="flip">Flip (1 kartu 2 data)</option>
            <option value="mercy">Mercy (+10 / +8)</option>
            <option value="fkk">FKK</option>
          </select>
          <label for="unoOpponentMode">Lawan:</label>
          <select id="unoOpponentMode">
            <option value="bot" selected>Bot</option>
            <option value="local">2 Player Offline</option>
          </select>
          <label for="unoDifficulty">Bot:</label>
          <select id="unoDifficulty">
            <option value="easy">Easy</option>
            <option value="normal" selected>Normal</option>
            <option value="hard">Hard</option>
          </select>
          <button id="startUno">Mulai Ulang UNO</button>
          <button id="unoDraw">Ambil Kartu</button>
          <button id="unoCall">UNO!</button>
        </div>
        <div class="panel-row">
          <span id="unoStatus" class="status-pill"></span>
          <span id="unoRound" class="status-pill">Round: 1</span>
          <span id="unoScorePlayer" class="status-pill">Kamu: 0</span>
          <span id="unoScoreBot" class="status-pill">Bot: 0</span>
          <span id="unoTimer" class="status-pill">Timer: 20</span>
        </div>
        <div id="unoColorPicker" class="panel-row hidden">
          <span>Pilih warna wild:</span>
          <button class="color-btn" data-color="red">Red</button>
          <button class="color-btn" data-color="blue">Blue</button>
          <button class="color-btn" data-color="green">Green</button>
          <button class="color-btn" data-color="yellow">Yellow</button>
        </div>

        <div class="uno-table">
          <div id="unoOpponentLabel" class="uno-seat">ü§ñ Bot <span id="unoBotCount">0 kartu</span></div>
          <div class="uno-center">
            <div class="pile-wrap">
              <h3>Draw Pile</h3>
              <div id="unoDrawPile" class="card back">UNO</div>
            </div>
            <div class="pile-wrap">
              <h3>Discard</h3>
              <div id="unoTopCard" class="card">-</div>
            </div>
            <div class="pile-wrap">
              <h3>Sisi Flip</h3>
              <div id="unoSideBadge" class="status-pill">FRONT</div>
            </div>
          </div>
          <div class="uno-seat player">üßë Kamu</div>
        </div>

        <h3>Tangan Kamu (Player 1)</h3>
        <div id="unoHand" class="hand"></div>
        <h3 id="unoP2Title" class="hidden">Tangan Player 2</h3>
        <div id="unoHandP2" class="hand hidden"></div>

        <details class="rules-box">
          <summary>Hukum / Cara Main UNO</summary>
          <ul>
            <li>Mode Flip: satu kartu punya 2 data (front/back). Jika kartu <b>flip</b> keluar, sisi permainan dibalik.</li>
            <li>Mode Mercy: kartu aksi <b>+10</b>, <b>+8</b>, dan <b>reverse khusus</b> aktif (reverse = skip + penalti tambahan).</li>
            <li>Kartu dimainkan jika warna/angka cocok dengan kartu atas pada sisi aktif.</li>
          </ul>
        </details>
        <h3>Riwayat UNO</h3>
        <ul id="unoHistory"></ul>
      </section>

      <section id="chess" class="tab">
        <h2>Catur HD Battle</h2>
        <div class="panel-row card-panel">
          <button id="resetChess">Reset Catur</button>
          <span id="chessStatus" class="status-pill"></span>
        </div>
        <div class="chess-wrap"><div id="chessBoard" class="chess-board"></div><aside class="info-card"><h3>Bidak Tertangkap</h3><p>Putih menangkap:</p><div id="chessCapturedWhite" class="captured-row"></div><p>Hitam menangkap:</p><div id="chessCapturedBlack" class="captured-row"></div></aside></div>

        <details class="rules-box">
          <summary>Hukum / Cara Main Catur (Versi Game Ini)</summary>
          <ul>
            <li>Langkah dasar bidak valid (pawn, knight, bishop, rook, queen, king).</li>
            <li>Jika Raja atau Ratu tertangkap maka game tamat.</li>
            <li>Bisa dimainkan P2P: langkah sinkron antar device.</li>
          </ul>
        </details>
      </section>

      <section id="monopoly" class="tab">
        <h2>Monopoly Bank + Board HD</h2>
        <div id="monopolyBoard" class="mono-board"></div><p class="hint">Board visual dibuat ala game asli: tile properti, pajak, chance, jail, dan go.</p>

        <div class="panel-row card-panel">
          <input id="playerName" placeholder="Nama pemain" />
          <input id="startBalance" type="number" placeholder="Saldo awal" value="1500" />
          <button id="addPlayer">Tambah Pemain</button>
        </div>
        <div class="panel-row card-panel">
          <select id="fromPlayer"></select>
          <select id="toPlayer"></select>
          <input id="transferAmount" type="number" placeholder="Jumlah transfer" />
          <button id="transferBtn">Transfer</button>
        </div>
        <div class="panel-row card-panel">
          <select id="bankPlayer"></select>
          <input id="bankAmount" type="number" placeholder="+ kredit, - debit" />
          <button id="bankTxnBtn">Transaksi Bank</button>
        </div>

        <h3>Daftar Saldo</h3>
        <ul id="bankLedger"></ul>
        <h3>Riwayat Transaksi</h3>
        <ul id="bankHistory"></ul>

        <details class="rules-box">
          <summary>Hukum / Cara Main Monopoly Bank Edition</summary>
          <ul>
            <li>Board ditampilkan visual HD 16 tile utama.</li>
            <li>Banker bisa kredit/debit; transfer antar pemain jika saldo cukup.</li>
            <li>Saldo ‚â§ 0 dianggap bangkrut dan dicatat.</li>
          </ul>
        </details>
      </section>

      <section id="hand-ai" class="tab">
        <h2>Hand Avatar AI</h2>
        <div class="panel-row card-panel">
          <button id="startHandTracking">Start Kamera & Hand Tracking</button>
          <button id="stopHandTracking">Stop</button>
          <label for="handViewMode">Mode Tampilan:</label>
          <select id="handViewMode">
            <option value="camera">Kamera Besar</option>
            <option value="stage">Animasi Besar + Kamera Kecil Samping</option>
          </select>
          <label><input id="horrorModeToggle" type="checkbox" checked /> Horror FX</label>
          <span id="handStatus" class="status-pill">Status: idle</span>
        </div>

        <div class="hand-ai-layout">
          <div class="info-card">
            <h3>Kamera</h3>
            <video id="handVideo" autoplay playsinline muted></video>
            <canvas id="handOverlay"></canvas>
          </div>
          <div class="info-card">
            <h3>Avatar Animate</h3>
            <div id="avatarFace" class="avatar-face">
              <div class="eyes"><span class="eye"></span><span class="eye"></span></div>
              <div id="avatarMouth" class="mouth neutral"></div>
            </div>
            <p id="gestureLabel">Gesture terdeteksi: -</p>
            <p id="fingerCountLabel">Jumlah jari: 0</p>
            <div id="handFxStage" class="hand-fx-stage"></div>
            <canvas id="threeFxCanvas"></canvas>
            <p id="aiModelStatus" class="status-pill">Transformer.js: loading...</p>
          </div>
        </div>

        <h3>AI Learning Gesture</h3>
        <div class="panel-row card-panel">
          <input id="gestureName" placeholder="Nama gesture" />
          <button id="saveGestureBtn">Simpan Gesture Saat Ini</button>
          <button id="clearGestureBtn">Hapus Semua Data AI</button>
        </div>
        <ul id="gestureSamples"></ul>
      </section>
      <div id="globalFxOverlay" class="global-fx-overlay"></div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.4/dist/peerjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.min.js"></script>
    <script type="module" src="transformers-bridge.js"></script>
    <script src="app.js"></script>
  </body>
</html>
